---
import "../../public/styles/footer.css";
---

<footer class="footer">
  <div class="footer-inner">
    <p class="footer-text" data-text="Â© Protocol Zero - Est. 2025"></p>
  </div>
</footer>

<script>
  const footerText = document.querySelector('.footer-text');
  const fullText = footerText?.getAttribute('data-text') || '';

  let hasAnimated = false;

  function animateText() {
    if (hasAnimated || !footerText) return;

    const glitchChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%&*-+=<>?/\\|[]{}';
    let currentIteration = 0;

    footerText.textContent = fullText;

    const interval = setInterval(() => {
      footerText.textContent = fullText
        .split('')
        .map((_, index) => {
          if (index < currentIteration) {
            return fullText[index];
          }
          return glitchChars[Math.floor(Math.random() * glitchChars.length)];
        })
        .join('');

      if (currentIteration >= fullText.length) {
        clearInterval(interval);
        footerText.textContent = fullText;
        hasAnimated = true;
      }

      currentIteration += 1 / 3;
    }, 15);
  }

  // Create intersection observer to trigger animation when footer is visible
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting && !hasAnimated) {
          animateText();
        }
      });
    },
    { threshold: 0.5 }
  );

  if (footerText) {
    observer.observe(footerText);
  }
</script>