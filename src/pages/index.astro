---
import HeaderLayout from "../layouts/HeaderLayout.astro";
import FooterLayout from "../layouts/FooterLayout.astro";
import artists from "../data/artists.json";
import releases from "../data/releases.json";
import news from "../data/news.json";
---

<HeaderLayout title="Protocol Zero" active="">
  <link rel="stylesheet" href="/styles/pages.css" />
  <link rel="stylesheet" href="/styles/artists.css" />
  <link rel="stylesheet" href="/styles/releases.css" />
  <link rel="stylesheet" href="/styles/index-scroll.css" />

  <div class="main-scroll-container">
    <!-- Scroll Indicator Arrow -->
    <button class="scroll-indicator" aria-label="Scroll down">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="arrow-down">
        <path d="M12 5v14M5 12l7 7 7-7"/>
      </svg>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="arrow-up">
        <path d="M12 19V5M5 12l7-7 7 7"/>
      </svg>
    </button>

    <!-- Hero Section - News Slideshow -->
    <section id="home" class="hero-section hero-slideshow">
      <div class="hero-slideshow-container">
        {news.map((item, i) => (
          <div class="hero-slide" data-slide={i}>
            <div class="hero-slide-background" style={`background-image: url(${item.image})`}></div>
            <div class="hero-slide-content">
              <div class="hero-logo-container">
                <img src="/images/logo.svg" alt="Protocol Zero Logo" class="hero-logo" />
              </div>
              <div class="hero-news-content">
                <span class="news-type-label">{item.title}</span>
                <h1 class="news-heading">{item.heading}</h1>
                <p class="news-description">{item.description}</p>
                <a href={item.link} class="news-link">{item.linkText}</a>
              </div>
              <nav class="hero-menu">
              </nav>
            </div>
          </div>
        ))}
      </div>
      <div class="hero-slideshow-indicators">
        {news.map((_, i) => (
          <button class="hero-indicator" data-slide={i} aria-label={`Go to news ${i + 1}`}></button>
        ))}
      </div>
      <button class="hero-nav-btn prev" aria-label="Previous news">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M15 18l-6-6 6-6"/>
        </svg>
      </button>
      <button class="hero-nav-btn next" aria-label="Next news">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 18l6-6-6-6"/>
        </svg>
      </button>
    </section>

    <script>
      // Hero slideshow functionality
      let currentHeroSlide = 0;
      const heroSlides = document.querySelectorAll('.hero-slide');
      const heroIndicators = document.querySelectorAll('.hero-slideshow-indicators .hero-indicator');

      function showHeroSlide(index) {
        heroSlides.forEach((slide, i) => {
          slide.classList.toggle('active', i === index);
        });
        heroIndicators.forEach((indicator, i) => {
          indicator.classList.toggle('active', i === index);
        });
        currentHeroSlide = index;
      }

      function nextHeroSlide() {
        const next = (currentHeroSlide + 1) % heroSlides.length;
        showHeroSlide(next);
      }

      function prevHeroSlide() {
        const prev = (currentHeroSlide - 1 + heroSlides.length) % heroSlides.length;
        showHeroSlide(prev);
      }

      // Navigation buttons
      document.querySelectorAll('.hero-nav-btn.next').forEach(btn => {
        btn.addEventListener('click', nextHeroSlide);
      });

      document.querySelectorAll('.hero-nav-btn.prev').forEach(btn => {
        btn.addEventListener('click', prevHeroSlide);
      });

      // Indicators
      heroIndicators.forEach((indicator, i) => {
        indicator.addEventListener('click', () => showHeroSlide(i));
      });

      // Auto-play
      let heroAutoplay = setInterval(nextHeroSlide, 6000);

      // Pause on hover
      const heroSection = document.querySelector('.hero-slideshow');
      if (heroSection) {
        heroSection.addEventListener('mouseenter', () => clearInterval(heroAutoplay));
        heroSection.addEventListener('mouseleave', () => {
          clearInterval(heroAutoplay);
          heroAutoplay = setInterval(nextHeroSlide, 6000);
        });
      }

      // Initialize
      showHeroSlide(0);

      // Scroll indicator functionality
      const scrollIndicator = document.querySelector('.scroll-indicator');

      function updateScrollIndicator() {
        const scrollPosition = window.scrollY;
        const windowHeight = window.innerHeight;

        // Change arrow direction based on scroll position
        if (scrollPosition > windowHeight / 2) {
          scrollIndicator?.classList.add('scrolled');
          scrollIndicator?.setAttribute('aria-label', 'Scroll to top');
        } else {
          scrollIndicator?.classList.remove('scrolled');
          scrollIndicator?.setAttribute('aria-label', 'Scroll down');
        }
      }

      // Handle scroll indicator click - only scroll to top when arrow is up
      scrollIndicator?.addEventListener('click', () => {
        const scrollPosition = window.scrollY;
        const windowHeight = window.innerHeight;

        if (scrollPosition > windowHeight / 2) {
          // Scroll to top
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        // Do nothing when down arrow is showing
      });

      window.addEventListener('scroll', updateScrollIndicator, { passive: true });
      updateScrollIndicator();
    </script>

    <!-- About Section -->
    <section id="about" class="scroll-section about-section">
      <h1>ABOUT</h1>
      <div class="section-content">
        <p>Protocol Zero (P0) is an independent European drum & bass label founded between Slovakia and Italy by The Martens and Chr-s.</p>
        <p>Born from a shared vision of sound as both art and technology, the label focuses on the darker and more technical edges of drum & bass â€” from deep neurofunk to atmospheric techstep.</p>
        <p>P0 aims to connect European underground scenes through a unified aesthetic: precise sound design, immersive basslines, and a strong visual and conceptual identity.</p>
        <p>Born from a deep passion for dark and energetic drum & bass, the label stands for quality, precision and evolution in sound.</p>
      </div>
    </section>

    <!-- Artists Section -->
    <section id="artists" class="scroll-section artists-section">
      <h1>ARTISTS</h1>
      <div class="artists-grid">
        {artists.map((artist) => (
          <a href={`/artists/${artist.slug}`} class="artist-card">
            <img src={artist.image} alt={artist.name} loading="lazy" decoding="async" width="360" height="260" />
            <h2>{artist.name}</h2>
          </a>
        ))}
      </div>
    </section>

    <!-- Releases Section -->
    <section id="releases" class="scroll-section releases-section releases-slideshow">
      <div class="slideshow-container">
        {releases.map((rel, i) => (
          <div class="release-slide" data-slide={i}>
            <div class="slide-layout">
              <div class="slide-image-container">
                <img src={rel.image} alt={rel.title} class="slide-image" />
              </div>
              <div class="slide-content">
                <div class="slide-info">
                  <h2 class="slide-title">{rel.title}</h2>
                  <h3 class="slide-artist">{rel.artist}</h3>
                  <a href={`/releases/${rel.slug}`} class="slide-link">MORE INFO</a>
                  <div class="slide-date">{rel.date}</div>
                </div>
              </div>
            </div>
            <div class="slide-navigation">
              <button class="slide-nav-btn prev" aria-label="Previous slide">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M15 18l-6-6 6-6"/>
                </svg>
              </button>
              <button class="slide-nav-btn next" aria-label="Next slide">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M9 18l6-6-6-6"/>
                </svg>
              </button>
            </div>
          </div>
        ))}
      </div>
      <div class="slideshow-indicators">
        {releases.map((_, i) => (
          <button class="indicator" data-slide={i} aria-label={`Go to slide ${i + 1}`}></button>
        ))}
      </div>
    </section>

    <script>
      // Slideshow functionality
      let currentSlide = 0;
      const slides = document.querySelectorAll('.release-slide');
      const indicators = document.querySelectorAll('.slideshow-indicators .indicator');

      function showSlide(index) {
        slides.forEach((slide, i) => {
          slide.classList.toggle('active', i === index);
        });
        indicators.forEach((indicator, i) => {
          indicator.classList.toggle('active', i === index);
        });
        currentSlide = index;
      }

      function nextSlide() {
        const next = (currentSlide + 1) % slides.length;
        showSlide(next);
      }

      function prevSlide() {
        const prev = (currentSlide - 1 + slides.length) % slides.length;
        showSlide(prev);
      }

      // Navigation buttons
      document.querySelectorAll('.slide-nav-btn.next').forEach(btn => {
        btn.addEventListener('click', nextSlide);
      });

      document.querySelectorAll('.slide-nav-btn.prev').forEach(btn => {
        btn.addEventListener('click', prevSlide);
      });

      // Indicators
      indicators.forEach((indicator, i) => {
        indicator.addEventListener('click', () => showSlide(i));
      });

      // Auto-play (optional)
      let autoplay = setInterval(nextSlide, 5000);

      // Pause on hover
      const slideshowSection = document.querySelector('.releases-slideshow');
      if (slideshowSection) {
        slideshowSection.addEventListener('mouseenter', () => clearInterval(autoplay));
        slideshowSection.addEventListener('mouseleave', () => {
          clearInterval(autoplay);
          autoplay = setInterval(nextSlide, 5000);
        });
      }

      // Initialize
      showSlide(0);
    </script>

    <!-- Contacts Section -->
    <section id="contacts" class="scroll-section contacts-section">
      <h1>CONTACTS</h1>
      <div class="section-content">
        <p>For demo submissions or collaborations, feel free to reach out!</p>
        <p>Send us a private Soundcloud link at the following email:</p>
        <p><a href="mailto:demo@protocolzero.online">demo@protocolzero.online</a></p>
      </div>
    </section>
</HeaderLayout>

<FooterLayout />
